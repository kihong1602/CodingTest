# Problem 075

> BOJ 11438 LCA 2
> <br/>
> [링크](https://www.acmicpc.net/problem/11438)

## 문제

N개의 정점으로 이뤄진 트리가 주어진다. 트리의 각 정점은 1 ~ N 번이고, 루트는 1번이다.

두 노드의 쌍 M개가 주어졌을 때, 두 노드의 가장 가까운 공통 조상이 몇번인지 출력하는 문제다.

## 풀이

Problem 074 보다 노드의 개수와 M의 개수가 매우 커졌다. 따라서 전통적인 `LCA`을 구현해 풀이하면 시간초과가 발생한다.

따라서 희소 배열을 사용한 방식으로 풀이해야한다.

## 해결 전략

- 입력값을 기반으로 트리를 구성한다.
- `BFS`또는 `DFS`를 사용해 각 노드의 깊이를 구한다. `BFS`를 사용한다.
- 점화식 `P[K][N] = P[K-1][P[K-1][N]]`을 이용해 부모 노드 ㅡ배열을 구한다.
- 깊이가 깊은 노드는 `parent`배열을 이용해 2^k만큼 빠르게 이동시켜 깊이를 맞춘다.
- 부모 노드로 올라가면서 최소 공통 조상을 찾는다. k는 깊이의 최댓값에서 1씩 감소하면서 올라간다.

- 입력값을 기반으로 트리를 구성한다.
- `BFS`를 사용해 각 노드의 깊이와 1-depth 부모 배열을 구한다.
- 점화식`P[K][N] = P[K-1][P[K-1][N]]`을 이용해 희소 배열(`P[K][N]`)을 채운다.
- 깊이가 깊은 노드는 희소 배열을 사용해 2^k 단위로 빠르게 이동해 깊이를 맞춘다.
- 깊이가 같아진 후, 두 노드를 동시에 2^k 단위로 위로 이동시키며 최소 공통 조상을 찾는다.
- `parent[0][u]`를 반환해 최종 답을 구한다.
